<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta charset="UTF-8">
<style type="text/css">
#map_canvas {
    margin: 0;
    padding: 30%;
    height: 100%;
    position:fixed; 
    top:0px;

  }
</style>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
  var map;
      function initialize() {

        //initializing map view
        var myOptions = {
          zoom: 13,
          center: new google.maps.LatLng(42.32657009662249, -71.06678009033203),
          disableDefaultUI: true,
          panControl: true,
          zoomControl: true,
          
          scaleControl: true,
          mapTypeId: google.maps.MapTypeId.ROADMAP, 
          panControl: true,
          panControlOptions: {
            position: google.maps.ControlPosition.TOP_RIGHT
          },
          zoomControl: true,
          zoomControlOptions: {
            style: google.maps.ZoomControlStyle.LARGE,
            position: google.maps.ControlPosition.TOP_RIGHT
          }
        };
        map = new google.maps.Map(document.getElementById('map_canvas'),
            myOptions);

        //BIKE STUFF
        var bikeLayer = new google.maps.BicyclingLayer();
        bikeLayer.setMap(map);

        <% @user_reports.each do |x|%>
          addMarker(<%= x.latitude %>, <%=x.longitude%>);
        <% end %>
      }

      function addMarker(lat, long){
            var marker = new google.maps.Marker({
              position: new google.maps.LatLng(lat, long),
              map: map,
              title: 'REPORT'
            });
            //DROP PIN
            marker.setAnimation(google.maps.Animation.DROP);
            marker.setTitle('DROP');
            //DROP MARKER INFOWINDOW
            google.maps.event.addListener(marker, 'click', function(){
              infowindow.open(map, this);
              marker = this
            });
            var infowindow = new google.maps.InfoWindow({
              content:"Lat: " + lat + ", Long: " + long
            });
            //CLOSING MARKER INFOWINDOW
            google.maps.event.addListener(infowindow,'closeclick',function(){
              infowindow.close(map, this); //removes the marker
            });
        }    
      console.log("message")
      google.maps.event.addDomListener(window, 'load', initialize);
</script>